{% set _menu_active = 'calendar' %}
{% extends 'base.html.twig' %}
{% block body %}

<div class="row">
	<div class="col-sm-12">
	<ul class="nav nav-tabs nav-justified" role="tablist" style="margin: 15px 0; font-size: 13px;">
		<li role="presentation">
		{% if passage %}
			<a href="{{ path('calendarManuel',{'passage': passage.id, 'calendrier': calendarTool.getDateDebutSemaine('Y-m-d')}) }}" role="tab" style="color: black;"><i class="mdi mdi-apps mdi-lg"></i></a>
		{% else %}
	        <a href="{{ path('calendarManuel', {'calendrier': calendarTool.getDateDebutSemaine('Y-m-d')}) }}" role="tab" style="color: black;"><i class="mdi mdi-apps mdi-lg"></i></a>
	    {% endif %}
	    </li>
	{% set i=0 %}
	{% for tech in techniciens %}
	    <li role="presentation"{% if tech.getId() == technicien %} class="active"{% endif %}>
	        {% if passage %}
	        <a href="{{ path('calendar',{'passage': passage.id, 'technicien': tech.getId(), 'calendrier': calendarTool.getDateDebutSemaine('Y-m-d')}) }}" role="tab" style="color: {{ tech.getCouleur() }};"><i class="mdi mdi-face mdi-lg"></i> <strong>{{ tech.getInituleCourt() }}</strong></a>
	        {% else %}
	        <a href="{{ path('calendar',{'technicien': tech.getId(), 'calendrier': calendarTool.getDateDebutSemaine('Y-m-d')}) }}" role="tab" style="color: {{ tech.getCouleur() }};"><i class="mdi mdi-face mdi-lg"></i> <strong>{{ tech.getInituleCourt() }}</strong></a>
	        {% endif %}
	    </li>
	    {% set i=loop.index %}
	{% endfor %}
	</ul>
	</div>
</div>

<div class="row">
	<div class="col-sm-4">
		<div class="btn-group">
			<a href="{{ path('calendar',{'passage': passage.id, 'technicien': technicienObj.getId(), 'calendrier': calendarTool.getDateDebutSemaine('Y-m-d')}) }}" class="btn btn-default"><span class="glyphicon glyphicon-chevron-left"></span></a>
			<a href="" style="font-size: 24px; padding-bottom:0; padding-top: 0;" class="btn btn-link">18 au 24 Avril 2016</a>
			<a href="" class="btn btn-default"><span class="glyphicon glyphicon-chevron-right"></span></a>
		</div>
	</div>
	<div class="col-sm-5 text-center">
		{% if passage and not passage.dateFin %}
			<div id="fc-events">
	            <div class="event" style="display: inline-block; background: {{ technicienObj.getCouleur() }}; padding: 5px; border-radius: 4px; cursor: move;" data-identifiant="{{ passage.id }}" data-duration="{{ passage.dureePrevisionnelle }}" data-title="{{ passage.nom }} ({{ passage.etablissementInfos.adresse.codePostal }})">
					<span class="mdi mdi-today mdi-lg" aria-hidden="true"></span>&nbsp;{{ passage.etablissementInfos.nom }} <small>{{ passage.etablissementInfos.adresse.codePostal }} {{ passage.etablissementInfos.adresse.commune }}</small>
				</div>
			</div>
			<div class="hidden" id="retour_technicien_btn" >
				<a class="btn btn-sm btn-default" href="{{ path('passage')~'#filtre=["'~technicienObj.getIdentite()~'"]' }}"><span class="glyphicon glyphicon-arrow-left"></span>&nbsp;Retour aux passages de {{technicienObj.getIdentite()}}</a>
			</div>
		{% endif %}
	</div>
	<div class="col-sm-3 text-right">
		<div class="btn-group">
			<a href="" class="btn btn-md btn-default"><i class="mdi mdi-view-comfy"></i> Mois</a>
			<a href="" class="btn btn-default active"><i class="mdi mdi-view-week"></i> Semaine</a>
			<a href="" class="btn btn-md btn-default"><i class="mdi mdi-view-day"></i> Jour</a>
		</div>
	</div>
</div>
<div class="row">
	<div class="col-sm-12">
		<div
			id="calendrier"
			data-goto-date="{{ calendarTool.getDateDebutSemaine('Y-m-d') }}"
			data-url-populate="{{ path('calendarPopulate', {'technicien': technicien, 'calendrier': calendarTool.getDateDebutSemaine('Y-m-d')})}}"
			data-url-read="{{path('calendarRead', {'technicien': technicien, 'calendrier': calendarTool.getDateDebutSemaine('Y-m-d')})}}"
			{% if passage %}
			data-url-update="{{path('calendarUpdate', {'passage': passage.id, 'technicien': technicien, 'calendrier': calendarTool.getDateDebutSemaine('Y-m-d')})}}"
			data-url-prev="{{ path('calendar',{'passage': passage.id, 'technicien': technicien, 'calendrier': calendarTool.getSemainePrecedente('Y-m-d')}) }}"
			data-url-next="{{ path('calendar',{'passage': passage.id, 'technicien': technicien, 'calendrier': calendarTool.getSemaineSuivante('Y-m-d')}) }}"
			{% else %}
			data-url-update="{{path('calendarUpdate', {'technicien': technicien, 'calendrier': calendarTool.getDateDebutSemaine('Y-m-d')})}}"
			data-url-prev="{{ path('calendar',{'technicien': technicien, 'calendrier': calendarTool.getSemainePrecedente('Y-m-d')}) }}"
			data-url-next="{{ path('calendar',{'technicien': technicien, 'calendrier': calendarTool.getSemaineSuivante('Y-m-d')}) }}"
			{% endif %}
		>
		</div>
	</div>
</div>

<div class="modal fade" id="modal-calendrier-infos" tabindex="-1" role="dialog">
	<div class="modal-dialog modal-lg" role="document">
	<div class="modal-content">
			<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
			<h4 class="modal-title" id="modal-title"></h4>
			</div>
			<div class="modal-body" id="modal-body"></div>
	</div>
	</div>
</div>
{% endblock %}
