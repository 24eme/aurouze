<div class="panel panel-default">
    <div class="panel-heading">Contrat de type <strong>{{ contrat.getTypeContratLibelle() }}</strong></div>
    <div class="panel-body">
        <div class="row">
            {% if contrat.referenceClient %}
            <div class="col-xs-12">
            	Numéro de commande : <strong>{{ contrat.referenceClient }}</strong>
            </div>
            {% endif %}
            <div class="col-xs-6">
                {% if contrat.getCommercial() %}Commercial : <strong>{{ contrat.getCommercial().getIdentite() }}</strong><br />{% endif %}
                <strong>{{ contrat.getDateDebut()|date("d/m/Y") }}</strong> (<strong>{{ contrat.getDuree() }}</strong> mois)<br />
                {% if contrat.getDureeGarantie() %}Garantie : <strong>{{ contrat.getDureeGarantie() }}</strong> mois{% endif %}
            </div>
            <div class="col-xs-6">
                {% if contrat.getTechnicien() %}
                    Technicien : <strong>{{ contrat.getTechnicien().getIdentite() }}</strong><br />
                {% endif %}
                <strong>{{ contrat.getNbPassages() }}</strong> passage{% if contrat.getNbPassages() > 1 %}s{% endif %} de <strong>{{ contrat.getHumanDureePassage() }}</strong>
            </div>
        </div>
    </div>
</div>

<h1 class="text-center">
    {{ contrat.getPrixHt() }}&nbsp;<small>€&nbsp;HT{% if contrat.getTvaReduite() %} (TVA réduite){% endif %}</small> <small>en {{ contrat.nbFactures }} factures</small>
</h1>

<br/>

<div class="panel panel-default">
    <div class="panel-heading"><h3 class="panel-title">Lieux de passage : </h3></div>
    <ul class="list-group">
        {% for etablissement in contrat.getEtablissements %}
            <li class="list-group-item"><span>{{ etablissement.intitule }}</span></li>
        {% endfor %}
    </ul>
</div>
<div class="panel panel-default">
    <div class="panel-heading"><h3 class="panel-title">Nomenclature</h3></div>
    <div class="panel-body">
        {{ contrat.getNomenclature() | nl2br }}
    </div>
</div>

{%  if(contrat.isEnAttenteAcceptation()) %}
    {{ include('contrat/contrat_previsionnel.html.twig', { 'contrat': contrat }) }}
{%  else %}
    {{ include('contrat/contrat_passages.html.twig', { 'contrat': contrat }) }}
{% endif %}


<div class="panel panel-default">
    <div class="panel-heading"><h3 class="panel-title">Produits</h3></div>
    <table class="table table-bordered table-condensed table-stripped">
        <thead>
            <tr>
                <th class="col-xs-2 text-center">  <strong>Nombre prévu</strong></th>
                <th class="col-xs-6">Nom produit</th>
                <th class="col-xs-2"><span class="text-muted">Prix d'achat</span></th>
                <th class="col-xs-2"><span class="text-muted">Prix de vente prestation</span></th>
            </tr>
        </thead>
        <tbody>
            {% for produit in contrat.produits %}
                <tr>
                    <td class="col-xs-2 text-right">  <strong>{{ produit.nbTotalContrat }}</strong></td>
                    <td class="col-xs-6">{{ produit.nom }} {% if(produit.conditionnement) %}<small class="text-muted">({{ produit.conditionnement }})</small>{% endif %}</td>
                    <td class="col-xs-2">  <span class="text-muted">{{ produit.prixHt }}&nbsp;€&nbsp;HT</span></td>
                    <td class="col-xs-2">  <span class="text-muted">{{ produit.prixPrestation }}&nbsp;€&nbsp;HT</span></td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
